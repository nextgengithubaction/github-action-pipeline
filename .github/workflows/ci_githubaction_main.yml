name: CI

on:
  workflow_dispatch:

jobs:
#  SonarScan: 
#    uses: ./.github/workflows/Dotnet_Build_Sonar_Scan.yml
#    secrets: inherit
#
#  CodeQL: 
#    uses: ./.github/workflows/codeql.yml
#    secrets: inherit
#    permissions:
#      actions: read
#      security-events: write
#      contents: read
#
#  SonarJIRA:
#    needs: SonarScan
#    uses: ./.github/workflows/Sonar_Python_Jira.yml
#    secrets: inherit
#
#  Dependabot:
#    uses: ./.github/workflows/dependabot_scanning.yml
#
#  Checkmarx:
#    uses: ./.github/workflows/checkmarx.yml
#    secrets: inherit
#    permissions:
#      contents: read
#      security-events: write
#      actions: read
#
  BuildandDeploy:
    uses: ./.github/workflows/build_and_push.yaml
    #needs: [SonarScan, CodeQL, SonarJIRA, Dependabot, Checkmarx]
    secrets: inherit
  CDInvocation:
   runs-on: dindrunner
   permissions: 
     contents: write
     security-events: write
     actions: write
   steps:
     - name: Repository Dispatch
       uses: peter-evans/repository-dispatch@v2
       with:
          event-type: my-event
          token: ${{ secrets.GITHUB_TOKEN }}
